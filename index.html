<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tokn - Create and Explore Solana Tokens</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/solana-web3.js/1.32.0/solana-web3.min.js"></script>
</head>
<body>

    <!-- Header Section -->
    <header>
        <h1>Welcome to Tokn</h1>
        <p>Create, manage, and explore your own Solana tokens.</p>
        <button onclick="window.location.href='create.html'" id="create-token-btn" disabled>Create Your Token</button>

        <!-- Connect Wallet Button -->
        <button id="connect-wallet-btn" onclick="connectWallet()">Connect Wallet</button>
        <p id="wallet-address" style="color: #00bcd4; font-size: 18px; display: none;">Wallet Connected: <span id="address"></span></p>
        <p id="wallet-balance" style="color: #00bcd4; font-size: 18px; display: none;">Balance: <span id="balance"></span> SOL</p>
    </header>

    <!-- Token List Section -->
    <section class="token-list">
        <h2>Featured Tokens</h2>
        
        <div class="token-card">
            <h3>Token 1</h3>
            <p>This is an innovative token launched on Solana's blockchain.</p>
            <div class="token-info">
                <p><strong>Bonding Curve:</strong> Exponential</p>
                <p><strong>Liquidity Pool:</strong> Raydium</p>
                <p><strong>Price:</strong> 0.5 SOL</p>
            </div>
            <button onclick="window.location.href='token1-details.html'">View Token</button>
        </div>

        <div class="token-card">
            <h3>Token 2</h3>
            <p>A token designed for decentralized finance and governance.</p>
            <div class="token-info">
                <p><strong>Bonding Curve:</strong> Linear</p>
                <p><strong>Liquidity Pool:</strong> Serum</p>
                <p><strong>Price:</strong> 0.2 SOL</p>
            </div>
            <button onclick="window.location.href='token2-details.html'">View Token</button>
        </div>

        <div class="token-card">
            <h3>Token 3</h3>
            <p>This token is designed for decentralized applications on Solana.</p>
            <div class="token-info">
                <p><strong>Bonding Curve:</strong> Logarithmic</p>
                <p><strong>Liquidity Pool:</strong> Orca</p>
                <p><strong>Price:</strong> 0.8 SOL</p>
            </div>
            <button onclick="window.location.href='token3-details.html'">View Token</button>
        </div>
    </section>

    <!-- Explore & Launch Section -->
    <section class="explore-launch">
        <div class="explore-box">
            <h2>Explore Tokens</h2>
            <p>Discover a wide range of Solana-based tokens created by the Tokn community. Dive into bonding curves, liquidity pools, and more!</p>
            <button onclick="window.location.href='explore.html'">Explore Tokens</button>
        </div>

        <div class="launch-box">
            <h2>Launch Your Own Token</h2>
            <p>Ready to launch your own token on Solana? Create a custom bonding curve, deploy liquidity to decentralized exchanges like Raydium, and more.</p>
            <button onclick="window.location.href='create.html'" id="launch-token-btn" disabled>Launch Token</button>
        </div>
    </section>

    <!-- Footer Section -->
    <footer>
        <p>&copy; 2025 Tokn. All rights reserved. <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
    </footer>

    <script>
        let userWallet = null;

        // Connect to the wallet
        async function connectWallet() {
            try {
                const { solana } = window;

                // Check if Phantom wallet is installed
                if (solana && solana.isPhantom) {
                    const response = await solana.connect();
                    userWallet = response.publicKey.toString();

                    document.getElementById("wallet-address").style.display = "block";
                    document.getElementById("address").textContent = userWallet;

                    // Enable the Create Token button once wallet is connected
                    document.getElementById("create-token-btn").disabled = false;
                    document.getElementById("launch-token-btn").disabled = false;

                    // Fetch and display wallet balance
                    getWalletBalance();
                } else {
                    alert("Please install Phantom wallet.");
                }
            } catch (err) {
                console.error("Wallet connection failed", err);
                alert("Connection failed. Please try again.");
            }
        }

        // Fetch Wallet Balance (in SOL)
        async function getWalletBalance() {
            if (!userWallet) {
                console.error("Wallet not connected");
                return;
            }
            try {
                const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'), 'confirmed');
                const publicKey = new solanaWeb3.PublicKey(userWallet);

                // Fetch SOL balance
                const balance = await connection.getBalance(publicKey);
                const solBalance = balance / solanaWeb3.LAMPORTS_PER_SOL;

                document.getElementById("wallet-balance").style.display = "block";
                document.getElementById("balance").textContent = solBalance.toFixed(3);
            } catch (err) {
                console.error("Error fetching balance", err);
            }
        }

        // Enable token transfer functionality
        async function transferTokens() {
            if (!userWallet) {
                alert("Please connect your wallet first.");
                return;
            }

            // Prompt for recipient address and amount
            const recipient = prompt("Enter recipient's wallet address:");
            const amount = parseFloat(prompt("Enter the amount to send (in SOL):"));

            if (recipient && !isNaN(amount)) {
                try {
                    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'), 'confirmed');
                    const fromWallet = new solanaWeb3.PublicKey(userWallet);
                    const toWallet = new solanaWeb3.PublicKey(recipient);

                    const transaction = new solanaWeb3.Transaction().add(
                        solanaWeb3.SystemProgram.transfer({
                            fromPubkey: fromWallet,
                            toPubkey: toWallet,
                            lamports: amount * solanaWeb3.LAMPORTS_PER_SOL, // Convert SOL to lamports
                        })
                    );

                    const { solana } = window;
                    const signature = await solana.signAndSendTransaction(transaction);
                    await connection.confirmTransaction(signature);
                    alert(`Successfully sent ${amount} SOL to ${recipient}`);
                } catch (err) {
                    console.error("Error sending transaction", err);
                    alert("Transaction failed.");
                }
            } else {
                alert("Invalid input. Please check the recipient address and amount.");
            }
        }
    </script>

</body>
</html>
